---
title: 多表设计
date: 2016-05-29 10:12:48
tags:
	MySQL
---

多表设计有“一对多”，“多对多”，“一对一”三种表现形式。

一对多：
顾客与订单之间就是一对多的关系，一位顾客可以生成很多订单，很多订单由某一位顾客生成。
创建顾客`customers`与	订单`orders`的数据库：
```
CREATE TABLE customers(
	id int,
	name varchar(100),
	address varchar(255),
	PRIMARY KEY(id)
);
```

<!--more-->

```
CREATE TABLE orders(
	id int PRIMARY KEY,
	order_num varchar(100),
	price float(8,2),
	status int,
	customer_id int,
	CONSTRAINT customer_id_fk FOREIGN KEY(customer_id) REFERENCES customers(id)
);
```

对orders表中的最后一句做解释：
- `CONSTRAINT`
定义外键约束。用来添加完整性约束条件，并且指定该约束条件的名字(这样就方便以后删除这个约束条件)

- `customer_id_fk`
约束名称，库中要唯一

- `FOREIGN KEY()`
表示这是一个外部键

- `customer_id`
表示本表中`customer_id`是外部键

- `REFERENCES`
表示参考的是外部的哪个键

- `customers(id)`
表示参考的是customers表中的`id`键

多对多
比如老师和学生之间的关系就是多对多的关系，一个老师教过很多学生，一个学生被很多老师教过。设计以下表结构：
```
CREATE TABLE teachers(
				id int PRIMARY KEY,
				name varchar(100),
				salary float(8,2)
			);
			CREATE TABLE students(
				id int PRIMARY KEY,
				name varchar(100),
				grade varchar(100)
			);
```
但是要实现多对多的关系，还需要创建第三张表，把以上两张联合起来
```
CREATE TABLE teacher_student(
				t_id int,
				s_id int,
				PRIMARY KEY(t_id,s_id),
				CONSTRAINT teacher_id_fk FOREIGN KEY(t_id) REFERENCES teachers(id),
				CONSTRAINT student_id_fk FOREIGN KEY(s_id) REFERENCES students(id)
			);
```
其中，`PRIMARY KEY(t_id,s_id),`为联合主键，避免了重复
类的设计：
```
public class Teacher{//多对多
				private int id;
				private String name;
				private float salary;
				private List<Student> students;
			}
			public class Student{
				private int id;
				private String name;
				private String grade;
				private List<Teacher> teachers;
			}
```

一对一：
一对一，其实就是一张表。。。。