---
title: 实现类似饿了么网站标题栏的交互
date: 2016-08-24 22:30:00
tags:
	前端
---

<img src='http://ob9qd20l4.bkt.clouddn.com/elemo.jpg' class='full-image' >

<!--more-->

用到了PageVisibility API。
PageVisibility API用于判断页面是否处于浏览器的当前窗口，即是否可见。
### 属性
这个API部署在document对象上，提供以下两个属性。
- document.hidden：返回一个布尔值，表示当前是否被隐藏
- document.visibilityState：表示页面当前的状态，可以取三个值，分别是visibile（页面可见）、hidden（页面不可见）、prerender（页面正处于渲染之中，不可见）。

### VisibilityChange事件
当页面的可见状态发生变化时，会触发VisibilityChange事件（带有浏览器前缀）。
```
document.addEventListener("visibilitychange", function() {
  console.log( document.visibilityState );
});
```

饿了么网站的页面标题交互效果：
![饿了么网站的页面标题交换效果](http://ob9qd20l4.bkt.clouddn.com/QQ%E6%88%AA%E5%9B%BE20160824224100.jpg)


下面是实现页面切换后标题改变的Demo:


```
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>网页标题处</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<script type="text/javascript">
		var title = document.title;				//保存原网页的名称
		document.addEventListener("visibilitychange", function() {  
			  console.log(document.visibilityState);
			  if (document.visibilityState == 'hidden' ) {
			  		document.title = '不要离开我！！！';
			  } else if (document.visibilityState == 'visible') {
			  		console.log(title);
			  		document.title = title;
			  }
		});
	</script>
</body>
</html>
```
实现的效果：
![实现的效果](http://ob9qd20l4.bkt.clouddn.com/QQ%E6%88%AA%E5%9B%BE20160825003855.jpg)

### 参考链接
阮一峰：[Page Visibility API](http://javascript.ruanyifeng.com/htmlapi/pagevisibility.html)